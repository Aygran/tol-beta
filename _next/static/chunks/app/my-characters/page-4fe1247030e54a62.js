(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[605],{6661:function(e,t,r){Promise.resolve().then(r.bind(r,6953))},7907:function(e,t,r){"use strict";var i=r(5313);r.o(i,"usePathname")&&r.d(t,{usePathname:function(){return i.usePathname}}),r.o(i,"useRouter")&&r.d(t,{useRouter:function(){return i.useRouter}})},6953:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var i=r(3827),a=r(4090),s=r(3779),n=r(4624),o=r(7907);function c(e){let{children:t}=e,{user:r,loading:n}=(0,s.useAuth)(),c=(0,o.useRouter)();return((0,a.useEffect)(()=>{n||r||c.push("/login")},[r,n,c]),n)?(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-900",children:(0,i.jsx)("div",{className:"text-white text-xl",children:"Loading..."})}):r?(0,i.jsx)(i.Fragment,{children:t}):null}function l(){let{user:e}=(0,s.useAuth)(),[t,r]=(0,a.useState)([]),[l,d]=(0,a.useState)(!0),[u,h]=(0,a.useState)(""),f=(0,o.useRouter)();(0,a.useEffect)(()=>{e&&(async()=>{try{let t=await n.B.getCharacterSheets(e.uid);r(t)}catch(e){h("Failed to load characters"),console.error("Error loading characters:",e)}finally{d(!1)}})()},[e]);let m=async e=>{if(confirm("Are you sure you want to delete this character?"))try{await n.B.deleteCharacterSheet(e),r(t.filter(t=>t.id!==e))}catch(e){h("Failed to delete character"),console.error("Error deleting character:",e)}};return l?(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-900",children:(0,i.jsx)("div",{className:"text-white text-xl",children:"Loading characters..."})}):u?(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-900",children:(0,i.jsx)("div",{className:"text-red-500 text-xl",children:u})}):(0,i.jsx)(c,{children:(0,i.jsx)("div",{className:"min-h-screen bg-gray-900 py-12 px-4 sm:px-6 lg:px-8",children:(0,i.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("h1",{className:"text-3xl font-extrabold text-white sm:text-4xl",children:"My Characters"}),(0,i.jsx)("p",{className:"mt-3 text-xl text-gray-300",children:"Manage your character sheets"})]}),(0,i.jsx)("div",{className:"mt-12 grid gap-6 sm:grid-cols-2 lg:grid-cols-3",children:t.map(e=>(0,i.jsx)("div",{className:"bg-gray-800 rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300",children:(0,i.jsxs)("div",{className:"p-6",children:[(0,i.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:e.characterName}),(0,i.jsxs)("p",{className:"text-gray-300 text-sm mb-4",children:["Last updated: ",new Date(e.updatedAt).toLocaleDateString()]}),(0,i.jsxs)("div",{className:"flex justify-between space-x-4",children:[(0,i.jsx)("button",{onClick:()=>f.push("/character-sheet?id=".concat(e.id)),className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-800 transition-colors duration-200",children:"Edit"}),(0,i.jsx)("button",{onClick:()=>m(e.id),className:"flex-1 bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 focus:ring-offset-gray-800 transition-colors duration-200",children:"Delete"})]})]})},e.id))}),0===t.length&&(0,i.jsx)("div",{className:"text-center mt-12",children:(0,i.jsx)("p",{className:"text-gray-300 text-lg",children:"No characters found. Create your first character in the character sheet!"})})]})})})}},3779:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthProvider:function(){return c},useAuth:function(){return l}});var i=r(3827),a=r(4090),s=r(7065),n=r(1221);let o=(0,a.createContext)({user:null,loading:!0,signUp:async()=>{throw Error("AuthProvider not initialized")},signIn:async()=>{throw Error("AuthProvider not initialized")},signInWithGoogle:async()=>{throw Error("AuthProvider not initialized")},logout:async()=>{throw Error("AuthProvider not initialized")},verifyEmail:async()=>{throw Error("AuthProvider not initialized")}});function c(e){let{children:t}=e,[r,c]=(0,a.useState)(null),[l,d]=(0,a.useState)(!0);(0,a.useEffect)(()=>{if(!n.I){d(!1);return}let e=(0,s.Aj)(n.I,e=>{c(e),d(!1)});return()=>e()},[]);let u=async(e,t)=>{if(!n.I)throw Error("Authentication service is not available");let r=await (0,s.Xb)(n.I,e,t);return await (0,s.w$)(r.user),r},h=async(e,t)=>{if(!n.I)throw Error("Authentication service is not available");await (0,s.e5)(n.I,e,t)},f=async()=>{if(!n.I)throw Error("Authentication service is not available");let e=new s.hJ;await (0,s.rh)(n.I,e)},m=async()=>{if(!n.I)throw Error("Authentication service is not available");await (0,s.w7)(n.I)},x=async()=>{if(!(null===n.I||void 0===n.I?void 0:n.I.currentUser))throw Error("No user logged in");await (0,s.w$)(n.I.currentUser)};return(0,i.jsx)(o.Provider,{value:{user:r,loading:l,signUp:u,signIn:h,signInWithGoogle:f,logout:m,verifyEmail:x},children:t})}let l=()=>(0,a.useContext)(o)},1221:function(e,t,r){"use strict";let i,a,s;r.d(t,{I:function(){return a},db:function(){return s}});var n=r(6142),o=r(7065),c=r(8121);i=(0,n.C6)().length?(0,n.C6)()[0]:(0,n.ZF)({apiKey:"dummy",authDomain:"dummy",projectId:"dummy",storageBucket:"dummy",messagingSenderId:"dummy",appId:"dummy",measurementId:"dummy"}),a=(0,o.v0)(i),s=(0,c.ad)(i)},4624:function(e,t,r){"use strict";r.d(t,{B:function(){return n}});var i=r(8121),a=r(1221);class s{async createCharacterSheet(e){if(!a.db)throw Error("Firestore is not initialized");let t=new Date;return{id:(await (0,i.ET)(this.characterSheetsCollection,{...e,createdAt:t,updatedAt:t})).id,...e,createdAt:t,updatedAt:t}}async getCharacterSheets(e){if(!a.db)throw Error("Firestore is not initialized");let t=(0,i.IO)(this.characterSheetsCollection,(0,i.ar)("userId","==",e),(0,i.Xo)("updatedAt","desc"));return(await (0,i.PL)(t)).docs.map(e=>{var t,r;return{id:e.id,...e.data(),createdAt:null===(t=e.data().createdAt)||void 0===t?void 0:t.toDate(),updatedAt:null===(r=e.data().updatedAt)||void 0===r?void 0:r.toDate()}})}async getCharacterSheet(e){var t,r;if(!a.db)throw Error("Firestore is not initialized");let s=(0,i.JU)(this.characterSheetsCollection,e),n=await (0,i.QT)(s);if(!n.exists())return null;let o=n.data();return{id:n.id,...o,createdAt:null===(t=o.createdAt)||void 0===t?void 0:t.toDate(),updatedAt:null===(r=o.updatedAt)||void 0===r?void 0:r.toDate()}}async updateCharacterSheet(e,t){if(!a.db)throw Error("Firestore is not initialized");let r=(0,i.JU)(this.characterSheetsCollection,e);await (0,i.r7)(r,{...t,updatedAt:new Date})}async deleteCharacterSheet(e){if(!a.db)throw Error("Firestore is not initialized");let t=(0,i.JU)(this.characterSheetsCollection,e);await (0,i.oe)(t)}async subscribeToNewsletter(e,t){if(!a.db)throw Error("Firestore is not initialized");let r={userId:e,email:t,subscribedAt:new Date,isActive:!0};await (0,i.ET)(this.newsletterCollection,r)}async getNewsletterSubscription(e){var t;if(!a.db)throw Error("Firestore is not initialized");let r=(0,i.IO)(this.newsletterCollection,(0,i.ar)("userId","==",e),(0,i.b9)(1)),s=await (0,i.PL)(r);if(s.empty)return null;let n=s.docs[0].data();return{userId:n.userId,email:n.email,subscribedAt:null===(t=n.subscribedAt)||void 0===t?void 0:t.toDate(),isActive:n.isActive}}async unsubscribeFromNewsletter(e){if(!a.db)throw Error("Firestore is not initialized");let t=(0,i.IO)(this.newsletterCollection,(0,i.ar)("userId","==",e),(0,i.b9)(1)),r=await (0,i.PL)(t);if(!r.empty){let e=(0,i.JU)(this.newsletterCollection,r.docs[0].id);await (0,i.r7)(e,{isActive:!1})}}constructor(){if(!a.db)throw Error("Firestore is not initialized");this.characterSheetsCollection=(0,i.hJ)(a.db,"characterSheets"),this.newsletterCollection=(0,i.hJ)(a.db,"newsletterSubscriptions")}}let n=new s}},function(e){e.O(0,[358,657,897,971,69,744],function(){return e(e.s=6661)}),_N_E=e.O()}]);