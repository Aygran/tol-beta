(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[775],{6902:function(e,t,r){Promise.resolve().then(r.bind(r,2684))},7907:function(e,t,r){"use strict";var i=r(5313);r.o(i,"usePathname")&&r.d(t,{usePathname:function(){return i.usePathname}}),r.o(i,"useRouter")&&r.d(t,{useRouter:function(){return i.useRouter}})},2684:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var i=r(3827),a=r(4090),s=r(3779),n=r(4624),o=r(7907);function l(){let{user:e}=(0,s.useAuth)(),t=(0,o.useRouter)(),[r,l]=(0,a.useState)([]),[u,d]=(0,a.useState)(null),[c,h]=(0,a.useState)(!1),[m,b]=(0,a.useState)(!1);(0,a.useEffect)(()=>{e?f():t.push("/login")},[e,t]);let f=async()=>{if(e)try{b(!0);let t=(await n.B.getCharacterSheets(e.uid)).reduce((e,t)=>t.updatedAt>e.updatedAt?t:e);l(t.equipment||[])}catch(e){console.error("Failed to load equipment:",e),d({type:"error",message:"Failed to load equipment. Please try again."})}finally{b(!1)}};(0,a.useEffect)(()=>{if(u){h(!0);let e=setTimeout(()=>{h(!1),setTimeout(()=>{d(null)},500)},3e3);return()=>clearTimeout(e)}},[u]);let g=async()=>{if(e)try{b(!0);let t=await n.B.getCharacterSheets(e.uid);if(0===t.length){d({type:"error",message:"Please create a character first before adding equipment."});return}let i=t.reduce((e,t)=>t.updatedAt>e.updatedAt?t:e);if(!i.id){d({type:"error",message:"Character ID not found. Please try again."});return}await n.B.updateCharacterSheet(i.id,{equipment:r}),d({type:"success",message:"Equipment saved successfully!"})}catch(e){console.error("Failed to save equipment:",e),d({type:"error",message:"Failed to save equipment. Please try again."})}finally{b(!1)}},w=e=>{l(r.filter((t,r)=>r!==e))},v=(e,t,i)=>{let a=[...r];a[e]={...a[e],[t]:i},l(a)};return(0,i.jsx)("div",{className:"min-h-screen bg-gray-900 py-8 px-4 sm:px-6 lg:px-8",children:(0,i.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,i.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Equipment"}),(0,i.jsxs)("div",{className:"flex space-x-4",children:[(0,i.jsx)("button",{onClick:()=>{l([...r,{id:"temp-".concat(Date.now()),name:"",type:"",quantity:"",weight:"",value:"",av:"",notes:""}])},className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Add Equipment"}),(0,i.jsx)("button",{onClick:g,disabled:m,className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 disabled:bg-gray-600 disabled:cursor-not-allowed",children:m?"Saving...":"Save Equipment"})]})]}),u&&(0,i.jsx)("div",{className:"fixed top-4 right-4 p-4 rounded shadow-lg ".concat("success"===u.type?"bg-green-500":"bg-red-500"," text-white transition-opacity duration-500 ").concat(c?"opacity-100":"opacity-0"),children:u.message}),(0,i.jsx)("div",{className:"grid grid-cols-1 gap-6",children:r.map((e,t)=>(0,i.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow p-6",children:[(0,i.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,i.jsx)("input",{type:"text",value:e.name,onChange:e=>v(t,"name",e.target.value),placeholder:"Equipment Name",className:"text-xl font-semibold bg-transparent border-b border-gray-300 focus:outline-none focus:border-blue-500"}),(0,i.jsx)("button",{onClick:()=>w(t),className:"text-red-500 hover:text-red-700",children:"Remove"})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-white",children:"Type"}),(0,i.jsx)("input",{type:"text",value:e.type,onChange:e=>v(t,"type",e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-white",children:"Quantity"}),(0,i.jsx)("input",{type:"text",value:e.quantity,onChange:e=>v(t,"quantity",e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-white",children:"Weight"}),(0,i.jsx)("input",{type:"text",value:e.weight,onChange:e=>v(t,"weight",e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-white",children:"Value"}),(0,i.jsx)("input",{type:"text",value:e.value,onChange:e=>v(t,"value",e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-white",children:"AV"}),(0,i.jsx)("input",{type:"text",value:e.av,onChange:e=>v(t,"av",e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-white",children:"Notes"}),(0,i.jsx)("textarea",{value:e.notes,onChange:e=>v(t,"notes",e.target.value),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]})]},t))})]})})}},3779:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthProvider:function(){return l},useAuth:function(){return u}});var i=r(3827),a=r(4090),s=r(7065),n=r(1221);let o=(0,a.createContext)({user:null,loading:!0,signUp:async()=>{throw Error("AuthProvider not initialized")},signIn:async()=>{throw Error("AuthProvider not initialized")},signInWithGoogle:async()=>{throw Error("AuthProvider not initialized")},logout:async()=>{throw Error("AuthProvider not initialized")},verifyEmail:async()=>{throw Error("AuthProvider not initialized")}});function l(e){let{children:t}=e,[r,l]=(0,a.useState)(null),[u,d]=(0,a.useState)(!0);(0,a.useEffect)(()=>{if(!n.I){d(!1);return}let e=(0,s.Aj)(n.I,e=>{l(e),d(!1)});return()=>e()},[]);let c=async(e,t)=>{if(!n.I)throw Error("Authentication service is not available");let r=await (0,s.Xb)(n.I,e,t);return await (0,s.w$)(r.user),r},h=async(e,t)=>{if(!n.I)throw Error("Authentication service is not available");await (0,s.e5)(n.I,e,t)},m=async()=>{if(!n.I)throw Error("Authentication service is not available");let e=new s.hJ;await (0,s.rh)(n.I,e)},b=async()=>{if(!n.I)throw Error("Authentication service is not available");await (0,s.w7)(n.I)},f=async()=>{if(!(null===n.I||void 0===n.I?void 0:n.I.currentUser))throw Error("No user logged in");await (0,s.w$)(n.I.currentUser)};return(0,i.jsx)(o.Provider,{value:{user:r,loading:u,signUp:c,signIn:h,signInWithGoogle:m,logout:b,verifyEmail:f},children:t})}let u=()=>(0,a.useContext)(o)},1221:function(e,t,r){"use strict";let i,a,s;r.d(t,{I:function(){return a},db:function(){return s}});var n=r(6142),o=r(7065),l=r(8121);i=(0,n.C6)().length?(0,n.C6)()[0]:(0,n.ZF)({apiKey:"dummy",authDomain:"dummy",projectId:"dummy",storageBucket:"dummy",messagingSenderId:"dummy",appId:"dummy",measurementId:"dummy"}),a=(0,o.v0)(i),s=(0,l.ad)(i)},4624:function(e,t,r){"use strict";r.d(t,{B:function(){return n}});var i=r(8121),a=r(1221);class s{async createCharacterSheet(e){if(!a.db)throw Error("Firestore is not initialized");let t=new Date;return{id:(await (0,i.ET)(this.characterSheetsCollection,{...e,createdAt:t,updatedAt:t})).id,...e,createdAt:t,updatedAt:t}}async getCharacterSheets(e){if(!a.db)throw Error("Firestore is not initialized");let t=(0,i.IO)(this.characterSheetsCollection,(0,i.ar)("userId","==",e),(0,i.Xo)("updatedAt","desc"));return(await (0,i.PL)(t)).docs.map(e=>{var t,r;return{id:e.id,...e.data(),createdAt:null===(t=e.data().createdAt)||void 0===t?void 0:t.toDate(),updatedAt:null===(r=e.data().updatedAt)||void 0===r?void 0:r.toDate()}})}async getCharacterSheet(e){var t,r;if(!a.db)throw Error("Firestore is not initialized");let s=(0,i.JU)(this.characterSheetsCollection,e),n=await (0,i.QT)(s);if(!n.exists())return null;let o=n.data();return{id:n.id,...o,createdAt:null===(t=o.createdAt)||void 0===t?void 0:t.toDate(),updatedAt:null===(r=o.updatedAt)||void 0===r?void 0:r.toDate()}}async updateCharacterSheet(e,t){if(!a.db)throw Error("Firestore is not initialized");let r=(0,i.JU)(this.characterSheetsCollection,e);await (0,i.r7)(r,{...t,updatedAt:new Date})}async deleteCharacterSheet(e){if(!a.db)throw Error("Firestore is not initialized");let t=(0,i.JU)(this.characterSheetsCollection,e);await (0,i.oe)(t)}async subscribeToNewsletter(e,t){if(!a.db)throw Error("Firestore is not initialized");let r={userId:e,email:t,subscribedAt:new Date,isActive:!0};await (0,i.ET)(this.newsletterCollection,r)}async getNewsletterSubscription(e){var t;if(!a.db)throw Error("Firestore is not initialized");let r=(0,i.IO)(this.newsletterCollection,(0,i.ar)("userId","==",e),(0,i.b9)(1)),s=await (0,i.PL)(r);if(s.empty)return null;let n=s.docs[0].data();return{userId:n.userId,email:n.email,subscribedAt:null===(t=n.subscribedAt)||void 0===t?void 0:t.toDate(),isActive:n.isActive}}async unsubscribeFromNewsletter(e){if(!a.db)throw Error("Firestore is not initialized");let t=(0,i.IO)(this.newsletterCollection,(0,i.ar)("userId","==",e),(0,i.b9)(1)),r=await (0,i.PL)(t);if(!r.empty){let e=(0,i.JU)(this.newsletterCollection,r.docs[0].id);await (0,i.r7)(e,{isActive:!1})}}constructor(){if(!a.db)throw Error("Firestore is not initialized");this.characterSheetsCollection=(0,i.hJ)(a.db,"characterSheets"),this.newsletterCollection=(0,i.hJ)(a.db,"newsletterSubscriptions")}}let n=new s}},function(e){e.O(0,[358,657,897,971,69,744],function(){return e(e.s=6902)}),_N_E=e.O()}]);