(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[966],{4499:function(e,t,r){Promise.resolve().then(r.bind(r,5999))},7907:function(e,t,r){"use strict";var a=r(5313);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},5999:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var a=r(3827),i=r(4090),s=r(3779),n=r(7907),o=r(8792),l=r(4624);function d(){let[e,t]=(0,i.useState)(""),[r,d]=(0,i.useState)(""),[c,u]=(0,i.useState)(""),[h,m]=(0,i.useState)(!1),[b,w]=(0,i.useState)(""),[f,p]=(0,i.useState)(""),[v,y]=(0,i.useState)(!1),{signUp:x}=(0,s.useAuth)(),g=(0,n.useRouter)(),A=async t=>{if(t.preventDefault(),w(""),p(""),r!==c){w("Passwords do not match");return}y(!0);try{let t=await x(e,r);h&&await l.B.subscribeToNewsletter(t.user.uid,e),p("Account created successfully! Please check your email to verify your account."),g.push("/character-sheet")}catch(e){w(e.message||"Failed to create an account. Please try again."),console.error("Signup error:",e)}finally{y(!1)}};return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-900 py-12 px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-white",children:"Create your account"}),(0,a.jsxs)("p",{className:"mt-2 text-center text-sm text-gray-400",children:["Or"," ",(0,a.jsx)(o.default,{href:"/login",className:"font-medium text-blue-500 hover:text-blue-400",children:"sign in to your account"})]})]}),(0,a.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:A,children:[b&&(0,a.jsx)("div",{className:"bg-red-500/10 border border-red-500 text-red-500 px-4 py-3 rounded relative",role:"alert",children:(0,a.jsx)("span",{className:"block sm:inline",children:b})}),f&&(0,a.jsx)("div",{className:"bg-green-500/10 border border-green-500 text-green-500 px-4 py-3 rounded relative",role:"alert",children:(0,a.jsx)("span",{className:"block sm:inline",children:f})}),(0,a.jsxs)("div",{className:"rounded-md shadow-sm -space-y-px",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"sr-only",children:"Email address"}),(0,a.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:e,onChange:e=>t(e.target.value),className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-700 placeholder-gray-500 text-white bg-black rounded-t-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Email address"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"sr-only",children:"Password"}),(0,a.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,value:r,onChange:e=>d(e.target.value),className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-700 placeholder-gray-500 text-white bg-black focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Password"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"confirm-password",className:"sr-only",children:"Confirm Password"}),(0,a.jsx)("input",{id:"confirm-password",name:"confirm-password",type:"password",autoComplete:"new-password",required:!0,value:c,onChange:e=>u(e.target.value),className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-700 placeholder-gray-500 text-white bg-black rounded-b-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Confirm Password"})]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{id:"newsletter-opt-in",name:"newsletter-opt-in",type:"checkbox",checked:h,onChange:e=>m(e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-700 rounded bg-black"}),(0,a.jsx)("label",{htmlFor:"newsletter-opt-in",className:"ml-2 block text-sm text-gray-300",children:"I want to receive news and updates about Tree of Life TTRPG"})]}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{type:"submit",disabled:v,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-600 disabled:cursor-not-allowed",children:v?"Creating account...":"Create account"})})]})]})})}},3779:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthProvider:function(){return l},useAuth:function(){return d}});var a=r(3827),i=r(4090),s=r(7065),n=r(1221);let o=(0,i.createContext)({user:null,loading:!0,signUp:async()=>{throw Error("AuthProvider not initialized")},signIn:async()=>{throw Error("AuthProvider not initialized")},signInWithGoogle:async()=>{throw Error("AuthProvider not initialized")},logout:async()=>{throw Error("AuthProvider not initialized")},verifyEmail:async()=>{throw Error("AuthProvider not initialized")}});function l(e){let{children:t}=e,[r,l]=(0,i.useState)(null),[d,c]=(0,i.useState)(!0);(0,i.useEffect)(()=>{if(!n.I){c(!1);return}let e=(0,s.Aj)(n.I,e=>{l(e),c(!1)});return()=>e()},[]);let u=async(e,t)=>{if(!n.I)throw Error("Authentication service is not available");let r=await (0,s.Xb)(n.I,e,t);return await (0,s.w$)(r.user),r},h=async(e,t)=>{if(!n.I)throw Error("Authentication service is not available");await (0,s.e5)(n.I,e,t)},m=async()=>{if(!n.I)throw Error("Authentication service is not available");let e=new s.hJ;await (0,s.rh)(n.I,e)},b=async()=>{if(!n.I)throw Error("Authentication service is not available");await (0,s.w7)(n.I)},w=async()=>{if(!(null===n.I||void 0===n.I?void 0:n.I.currentUser))throw Error("No user logged in");await (0,s.w$)(n.I.currentUser)};return(0,a.jsx)(o.Provider,{value:{user:r,loading:d,signUp:u,signIn:h,signInWithGoogle:m,logout:b,verifyEmail:w},children:t})}let d=()=>(0,i.useContext)(o)},1221:function(e,t,r){"use strict";let a,i,s;r.d(t,{I:function(){return i},db:function(){return s}});var n=r(6142),o=r(7065),l=r(8121);a=(0,n.C6)().length?(0,n.C6)()[0]:(0,n.ZF)({apiKey:"dummy",authDomain:"dummy",projectId:"dummy",storageBucket:"dummy",messagingSenderId:"dummy",appId:"dummy",measurementId:"dummy"}),i=(0,o.v0)(a),s=(0,l.ad)(a)},4624:function(e,t,r){"use strict";r.d(t,{B:function(){return n}});var a=r(8121),i=r(1221);class s{async createCharacterSheet(e){if(!i.db)throw Error("Firestore is not initialized");let t=new Date;return{id:(await (0,a.ET)(this.characterSheetsCollection,{...e,createdAt:t,updatedAt:t})).id,...e,createdAt:t,updatedAt:t}}async getCharacterSheets(e){if(!i.db)throw Error("Firestore is not initialized");let t=(0,a.IO)(this.characterSheetsCollection,(0,a.ar)("userId","==",e),(0,a.Xo)("updatedAt","desc"));return(await (0,a.PL)(t)).docs.map(e=>{var t,r;return{id:e.id,...e.data(),createdAt:null===(t=e.data().createdAt)||void 0===t?void 0:t.toDate(),updatedAt:null===(r=e.data().updatedAt)||void 0===r?void 0:r.toDate()}})}async getCharacterSheet(e){var t,r;if(!i.db)throw Error("Firestore is not initialized");let s=(0,a.JU)(this.characterSheetsCollection,e),n=await (0,a.QT)(s);if(!n.exists())return null;let o=n.data();return{id:n.id,...o,createdAt:null===(t=o.createdAt)||void 0===t?void 0:t.toDate(),updatedAt:null===(r=o.updatedAt)||void 0===r?void 0:r.toDate()}}async updateCharacterSheet(e,t){if(!i.db)throw Error("Firestore is not initialized");let r=(0,a.JU)(this.characterSheetsCollection,e);await (0,a.r7)(r,{...t,updatedAt:new Date})}async deleteCharacterSheet(e){if(!i.db)throw Error("Firestore is not initialized");let t=(0,a.JU)(this.characterSheetsCollection,e);await (0,a.oe)(t)}async subscribeToNewsletter(e,t){if(!i.db)throw Error("Firestore is not initialized");let r={userId:e,email:t,subscribedAt:new Date,isActive:!0};await (0,a.ET)(this.newsletterCollection,r)}async getNewsletterSubscription(e){var t;if(!i.db)throw Error("Firestore is not initialized");let r=(0,a.IO)(this.newsletterCollection,(0,a.ar)("userId","==",e),(0,a.b9)(1)),s=await (0,a.PL)(r);if(s.empty)return null;let n=s.docs[0].data();return{userId:n.userId,email:n.email,subscribedAt:null===(t=n.subscribedAt)||void 0===t?void 0:t.toDate(),isActive:n.isActive}}async unsubscribeFromNewsletter(e){if(!i.db)throw Error("Firestore is not initialized");let t=(0,a.IO)(this.newsletterCollection,(0,a.ar)("userId","==",e),(0,a.b9)(1)),r=await (0,a.PL)(t);if(!r.empty){let e=(0,a.JU)(this.newsletterCollection,r.docs[0].id);await (0,a.r7)(e,{isActive:!1})}}constructor(){if(!i.db)throw Error("Firestore is not initialized");this.characterSheetsCollection=(0,a.hJ)(i.db,"characterSheets"),this.newsletterCollection=(0,a.hJ)(i.db,"newsletterSubscriptions")}}let n=new s}},function(e){e.O(0,[358,657,897,792,971,69,744],function(){return e(e.s=4499)}),_N_E=e.O()}]);